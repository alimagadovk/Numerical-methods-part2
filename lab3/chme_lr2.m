%%задание 4
% t0=0;
% tn=1;
% tau_h=[1 1/2 1/4 1/8 1/16 1/32 1/64];
% A=[0 0 0 0; 1/2 0 0 0; 0 1/2 0 0; 0 0 1 0];
% a=[0, 1/2, 1/2, 0];
% b=[1/6 1/3 1/3 1/6];
% u0=0.1;
% % ul=[];
% % for k=1:1:7
% %     U1=rungekutta(@myfun,t0,tn,u0, tau_h(k), A, a, b);
% %     ul=[ul U1(end)];
% % end
% % 
% % p1(1)=log2((ul(3)-ul(2))/(ul(2)-ul(1)));
% % p1(2)=log2((ul(4)-ul(3))/(ul(3)-ul(2)));
% % p1(3)=log2((ul(5)-ul(4))/(ul(4)-ul(3)));
% % p1(4)=log2((ul(6)-ul(5))/(ul(5)-ul(4)));
% % p1(5)=log2((ul(7)-ul(6))/(ul(6)-ul(5)));
% % x1=[tau_h(1) tau_h(2) tau_h(3) tau_h(4) tau_h(5)];
% % p1;
% % plot(x1, p1, '*'); grid on;
% 
% 
% u00=[1; -0.5; 0.6];
% ull=[];
% for k=1:1:7
%     U2=rungekutta(@ff,t0,tn,u00, tau_h(k), A, a, b)
% end
% 
%% задание 5
t0=0;
tn=1;
tau_h=[1 1/2 1/4 1/8 1/16 1/32 1/64];
butcher = [      0     0      0 0 0 0 0;...
               4/7     0      0 0 0 0 0;...
           115/112 -5/16      0 0 0 0 0;...
           589/630  5/18 -16/45 0 0 0 0;...
229/1200-29/6000*5^0.5 119/240-187/1200*5^0.5 -14/75+34/375*5^0.5 -3/100*5^0.5 0 0 0;...
71/2400-587/12000*5^0.5 187/480-391/2400*5^0.5 -38/75+26/375*5^0.5 27/80-3/400*5^0.5 (1+5^0.5)/4 0 0;...
-49/480+43/160*5^0.5 -425/96+51/32*5^0.5 52/15-4/5*5^0.5 -27/16+3/16*5^0.5 5/4-3/4*5^0.5 5/2-0.5*5^0.5 0];
a = [0 4/7 5/7 6/7 (5-5^0.5)/10 (5+5^0.5)/10 1];
b = [1/12 0 0 0 5/12 5/12 1/12];

% u0=0.1;
% ul=[];
% for k=1:1:7
%     U1=rungekutta(@myfun,t0,tn,u0, tau_h(k), butcher, a, b)
%     ul=[ul U1(end)];
% end
% 
% p1(1)=log2((ul(3)-ul(2))/(ul(2)-ul(1)));
% p1(2)=log2((ul(4)-ul(3))/(ul(3)-ul(2)));
% p1(3)=log2((ul(5)-ul(4))/(ul(4)-ul(3)));
% p1(4)=log2((ul(6)-ul(5))/(ul(5)-ul(4)));
% p1(5)=log2((ul(7)-ul(6))/(ul(6)-ul(5)));
% x1=[tau_h(1) tau_h(2) tau_h(3) tau_h(4) tau_h(5)];
% p1
% plot(x1, p1, '*'); grid on;

u00=[1; -0.5; 0.6];
ull=[];
% ull2={};
for k=1:1:7
    U2=rungekutta(@ff,t0,tn,u00, tau_h(k), butcher, a, b)
%     ull2=[ull2 {U2}];
end


