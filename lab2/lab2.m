close all
clear
clc
y = @(u,t)(u + t.^2 + 1);
A = [0 0 0 0; 0.5 0 0 0; 0 0.5 0 0; 0 0 1 0];
a = [0 0.5 0.5 1]';
b = [1/6 1/3 1/3 1/6];
u0 = 0.5;
v = [];
for j = 1:7
tau = 1/(2^(j - 1));
t = 0:tau:1;
U = fun(y, u0, t, A, a, b);
figure(j)
hold on
grid on
plot(t,U)
v = [v U(end)];
end
for i = 1:5
    p(i) = log2((v(i + 2) - v(i + 1))/(v(i + 1) - v(i)));
end
N = 1:5;
figure()
plot(N,p)
grid on
%% 2
close all
%%
A = [0 0 0 0; 0.5 0 0 0; 0 0.5 0 0; 0 0 1 0];
a = [0 0.5 0.5 1]';
b = [1/6 1/3 1/3 1/6];
for j = 1:7
tau = 1/(2^(j - 1));
t = 0:tau:1;
f = @(y,x)ff(x,y);
u0 = [1; -0.5; 0.6]';
U = fun(f, u0, t, A, a, b);
figure(j)
hold on
grid on
plot(t,U)
end
%%
close all
clear
clc
y = @(u,t)(u + t.^2 + 1);
butcher = [      0     0      0 0 0 0 0;...
               4/7     0      0 0 0 0 0;...
           115/112 -5/16      0 0 0 0 0;...
           589/630  5/18 -16/45 0 0 0 0;...
229/1200-29/6000*5^0.5 119/240-187/1200*5^0.5 -14/75+34/375*5^0.5 -3/100*5^0.5 0 0 0;...
71/2400-587/12000*5^0.5 187/480-391/2400*5^0.5 -38/75+26/375*5^0.5 27/80-3/400*5^0.5 (1+5^0.5)/4 0 0;...
-49/480+43/160*5^0.5 -425/96+51/32*5^0.5 52/15-4/5*5^0.5 -27/16+3/16*5^0.5 5/4-3/4*5^0.5 5/2-0.5*5^0.5 0];
 
a = [0 4/7 5/7 6/7 (5-5^0.5)/10 (5+5^0.5)/10 1];
b = [1/12 0 0 0 5/12 5/12 1/12];

u0 = 0.5;
v = [];
for j = 1:7
tau = 1/(2^(j - 1));
t = 0:tau:1;
U = fun(y, u0, t, butcher, a, b);
figure(j)
hold on
grid on
plot(t,U)
v = [v U(end)];
end
for i = 1:5
    p(i) = log2((v(i + 2) - v(i + 1))/(v(i + 1) - v(i)));
end
N = 1:5;
figure()
plot(N,p)
grid on
%%
close all
clear
clc
butcher = [      0     0      0 0 0 0 0;...
               4/7     0      0 0 0 0 0;...
           115/112 -5/16      0 0 0 0 0;...
           589/630  5/18 -16/45 0 0 0 0;...
229/1200-29/6000*5^0.5 119/240-187/1200*5^0.5 -14/75+34/375*5^0.5 -3/100*5^0.5 0 0 0;...
71/2400-587/12000*5^0.5 187/480-391/2400*5^0.5 -38/75+26/375*5^0.5 27/80-3/400*5^0.5 (1+5^0.5)/4 0 0;...
-49/480+43/160*5^0.5 -425/96+51/32*5^0.5 52/15-4/5*5^0.5 -27/16+3/16*5^0.5 5/4-3/4*5^0.5 5/2-0.5*5^0.5 0];
 
a = [0 4/7 5/7 6/7 (5-5^0.5)/10 (5+5^0.5)/10 1];
b = [1/12 0 0 0 5/12 5/12 1/12];
for j = 1:7
tau = 1/(2^(j - 1));
t = 0:tau:1;
f = @(y,x)ff(x,y);
u0 = [1; -0.5; 0.6]';
U = fun(f, u0, t, butcher, a, b);
figure(j)
hold on
grid on
plot(t,U)
end