clc
t = [0, 1];
butch = [      0     0      0 0 0 0 0;...
               4/7     0      0 0 0 0 0;...
           115/112 -5/16      0 0 0 0 0;...
           589/630  5/18 -16/45 0 0 0 0;...
229/1200-29/6000*5^0.5 119/240-187/1200*5^0.5 -14/75+34/375*5^0.5 -3/100*5^0.5 0 0 0;...
71/2400-587/12000*5^0.5 187/480-391/2400*5^0.5 -38/75+26/375*5^0.5 27/80-3/400*5^0.5 (1+5^0.5)/4 0 0;...
-49/480+43/160*5^0.5 -425/96+51/32*5^0.5 52/15-4/5*5^0.5 -27/16+3/16*5^0.5 5/4-3/4*5^0.5 5/2-0.5*5^0.5 0];
 
a = [0 4/7 5/7 6/7 (5-5^0.5)/10 (5+5^0.5)/10 1];
b = [1/12 0 0 0 5/12 5/12 1/12];

for i = 1:7
    u_n = 0.5;
    n = 2^(i-1);
    h = 1/n;
    t = 0:h:1;
    for k = 1:n
        t_n = [t(k) t(k+1)];
        u_n = kyt(t_n, u_n, a, b, butch, 0, 7);
    end
    disp(['Количество интервалов = ', num2str(n)])
    u_n
    u_mas(i) = u_n;
end

p_123 = log2( (u_mas(3)-u_mas(2))/(u_mas(2)-u_mas(1)) );
p_234 = log2( (u_mas(4)-u_mas(3))/(u_mas(3)-u_mas(2)) );
p_345 = log2( (u_mas(5)-u_mas(4))/(u_mas(4)-u_mas(3)) );
p_456 = log2( (u_mas(6)-u_mas(5))/(u_mas(5)-u_mas(4)) );
p_567 = log2( (u_mas(7)-u_mas(6))/(u_mas(6)-u_mas(5)) );
hold on
xlabel('номер тройки')
ylabel('эффективный порядок')
grid on
p = [p_123 p_234 p_345 p_456 p_567];
pi = [1 2 3 4 5];
plot(pi, p);
